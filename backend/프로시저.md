# 프로시저(Stored Procedure) 요약

## 1. 개념

-   **정의**: 데이터베이스에 저장된 SQL 문과 제어 흐름을 하나의 이름으로
    묶어 재사용할 수 있는 **저장된 프로그램**.
-   **특징**: 미리 컴파일되어 있어 호출 시 빠르게 실행되며, 반복되는
    복잡한 작업을 캡슐화한다.

## 2. 주요 목적

-   **코드 재사용**: 동일한 로직을 여러 애플리케이션에서 재활용.
-   **보안 강화**: 직접 SQL을 보내지 않고 프로시저 호출만으로 데이터
    조작.
-   **성능 향상**: DB 내부에서 실행되므로 네트워크 왕복 최소화.
-   **유지보수 편의**: 비즈니스 로직을 중앙 집중식으로 관리.

**핵심 사용 이유**
코드 재사용성이 가장 큰 장점 중 하나이지만, 단순히 재사용만을 위해서가
아니라 **보안·성능·트랜잭션 관리** 측면에서도 사용 가치가 크다.

## 3. 구조

``` sql
CREATE [OR REPLACE] PROCEDURE 프로시저명 (
    IN 매개변수1 데이터타입,
    OUT 매개변수2 데이터타입
)
BEGIN
    -- SQL 문
    -- 제어문(IF, LOOP 등)
END;
```

-   **IN**: 호출 시 값을 전달받음.
-   **OUT**: 프로시저 실행 후 값을 반환.
-   **INOUT**: 전달과 반환 모두 가능.

## 4. 장점

-   **성능**: 미리 컴파일된 상태로 빠른 실행.
-   **트랜잭션 관리**: 여러 SQL 문을 하나의 트랜잭션처럼 처리 가능.
-   **보안**: 사용자가 직접 테이블 접근 없이 프로시저만 호출 가능.

## 5. 단점

-   DB 종속성↑ → 다른 DBMS로 이식이 어려움.
-   복잡한 로직은 유지보수 어려움.
-   애플리케이션 레이어에서 버전 관리가 제한적.

## 6. 사용 예시

``` sql
-- 고객 등급을 업데이트하는 프로시저
CREATE OR REPLACE PROCEDURE update_customer_grade (IN p_id INT)
BEGIN
    UPDATE customers
    SET grade = 'VIP'
    WHERE id = p_id;
END;

-- 호출
CALL update_customer_grade(1001);
```

## 7. 활용 사례

-   반복적인 데이터 정리/집계 작업
-   배치 처리 및 스케줄링
-   트랜잭션 단위의 복합 비즈니스 로직 구현
